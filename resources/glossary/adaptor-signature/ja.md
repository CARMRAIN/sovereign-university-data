## アダプターシグネチャ

暗号化技術で、本物の署名と追加の署名（「アダプターシグネチャ」と呼ばれる）を組み合わせて秘密データを明らかにする方法です。この方法は、有効な署名、アダプターシグネチャ、および秘密の2つを知っていれば、不足している第三の要素を導き出すことができるように機能します。この方法の興味深い特性の一つは、もし私たちが相手のアダプターシグネチャと、このアダプターシグネチャを計算するために使用された秘密に関連する楕円曲線上の特定の点を知っている場合、直接秘密にアクセスすることなく、同じ秘密に対応する自分自身のアダプターシグネチャを導出することができるということです。信頼していない二つの当事者間の交換では、この技術は参加者間での二つの機密情報の同時公開を可能にします。このプロセスは、コインスワップやアトミックスワップなどの即時取引における信頼の必要性を排除します。理解を深めるために例を挙げましょう。AliceとBobは互いに1BTCを送り合いたいが、互いを信頼していません。そこで、交換における相手への信頼の必要性をなくすためにアダプターシグネチャを使用します（これは「アトミック」交換です）。彼らは以下のように進めます：
* Aliceがこのアトミック交換を開始します。彼女はBobに1BTCを送るトランザクション$m_A$を作成します。彼女は自分の秘密鍵$p_A$（$P_A = p_A \cdot G$）、ノンス$n_A$、および秘密$t$（$N_A = n_A \cdot G$および$T = t \cdot G$）を使用してこのトランザクションを検証する署名$s_A$を作成します：
$$s_A = n_A + t + H(N_A + T \parallel P_A \parallel m_A) \cdot p_A$$
&nbsp;
* Aliceは秘密$t$と彼女の本物の署名$s_A$からアダプターシグネチャ$s_A'$を計算します：
$$s_A' = s_A - t$$
&nbsp;
* AliceはBobに彼女のアダプターシグネチャ$s_A'$、署名されていないトランザクション$m_A$、秘密に対応する点$T$、およびノンスに対応する点$N_A$を送ります。これらの情報を「アダプター」と呼びます。ただし、これらの情報だけではBobはAliceのBTCを回収することができません。
* しかし、BobはAliceが彼をだましていないことを確認することができます。これを行うために、彼はAliceのアダプターシグネチャ$s_A'$が約束されたトランザクション$m_A$に適合することを確認します。次の方程式が正しい場合、彼はAliceのアダプターシグネチャが有効であると確信します：
$$s_A' \cdot G = N_A + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$
この検証により、BobはAliceから保証を受け取り、そのため彼は原子交換プロセスを安心して続けることができます。彼は次に、自分自身のトランザクション$m_B$を作成し、1BTCをAliceに送り、そして自分自身のアダプターシグネチャ$s_B'$を作成します。このシグネチャは、現時点でAliceだけが知っている同じ秘密$t$と関連付けられます（Bobはこの値$t$を知りませんが、Aliceが提供した対応するポイント$T$のみを知っています）：
$$s_B' = n_B + H(N_B + T \parallel P_B \parallel m_B) \cdot p_B$$
&nbsp;
Bobは、自分のアダプターシグネチャ$s_B'$、署名されていないトランザクション$m_B$、秘密に対応するポイント$T$、そしてnonceに対応するポイント$N_B$をAliceに送ります。これで、Aliceは自分だけが知っている秘密$t$とBobのアダプターシグネチャ$s_B'$を組み合わせて、BobからのBTCを送るトランザクション$m_B$に対する有効なシグネチャ$s_B$を計算することができます：
$$s_B = s_B' + t$$
&nbsp;
$$(s_B' + t) \cdot G = N_B + T + H(N_B + T \parallel P_B \parallel m_B) \cdot P_B$$
&nbsp;
Aliceは、この署名されたトランザクション$m_B$をBitcoinのブロックチェーンに公開し、Bobが彼女に約束したBTCを回収します。Bobはブロックチェーン上でこのトランザクションを確認し、その結果、シグネチャ$s_B = s_B' + t$を抽出することができます。この情報から、Bobは自分に必要だった有名な秘密$t$を特定することができます：
$$t = (s_B' + t) - s_B' = s_B - s_B'$$
&nbsp;
しかし、この秘密$t$は、Aliceのアダプターシグネチャ$s_A'$から有効なシグネチャ$s_A$を生成するためにBobが必要としていた唯一の情報でした。これにより、AliceからBobへBTCを送るトランザクション$m_A$を検証することができます。彼は$s_A$を計算し、次にトランザクション$m_A$を公開します：
$$s_A = s_A' + t$$
&nbsp;
$$(s_A' + t) \cdot G = N_A + T + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$
&nbsp;